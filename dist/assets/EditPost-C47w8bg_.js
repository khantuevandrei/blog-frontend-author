import{z as j,r as n,a as v,u as w,j as e,C,B as m,P as k,T as P,A as B}from"./index-D3NV2W8y.js";import{c as y,F as T}from"./FormButton-eHieQAR4.js";import{B as S}from"./BackButton-D7zhlBl-.js";function F(){const{postId:i}=j(),{token:u}=n.useContext(v),d=w(),[x,b]=n.useState(null),[a,p]=n.useState({title:"",body:""}),[c,o]=n.useState(null),[f,l]=n.useState({overlay:!0,update:!1});n.useEffect(()=>{async function r(){l(t=>({...t,overlay:!0}));try{const t=await fetch(`https://blog-backend-production-16f8.up.railway.app/api/posts/${i}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`bearer ${u}`}}),s=await t.json();if(!t.ok){o(s.message);return}b(s),p({title:s.title,body:s.body})}catch{o("Network error")}finally{l(t=>({...t,overlay:!1}))}}r()},[i,u]);function h(r){p({...a,[r.target.name]:r.target.value})}async function g(r){if(r.preventDefault(),o(null),l(t=>({...t,update:!0})),!a.title.trim()||!a.body.trim()){o("Both title and body are required");return}try{const t=await fetch(`https://blog-backend-production-16f8.up.railway.app/api/posts/${i}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`bearer ${u}`},body:JSON.stringify(a)}),s=await t.json();if(!t.ok){o(s.message||"Post creation failed");return}d(`/${x.id}`)}catch{o("Network error")}finally{l(t=>({...t,update:!1}))}}return f.overlay?e.jsx(C,{}):e.jsxs(m,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1,minHeight:"100%",p:2,position:"relative"},children:[e.jsx(S,{onClick:()=>d(`/${i}`)}),e.jsxs(k,{elevation:3,sx:{p:4,width:"100%",maxWidth:500},children:[e.jsx(P,{variant:"h5",mb:2,children:"Update Post"}),e.jsxs(m,{component:"form",onSubmit:g,children:[e.jsx(y,{label:"Title",name:"title",value:a.title,onChange:h,fullWidth:!0,required:!0,sx:{mb:2}}),e.jsx(y,{label:"Body",name:"body",value:a.body,onChange:h,fullWidth:!0,multiline:!0,rows:6,required:!0}),e.jsx(T,{name:"Update",disabled:f.update})]}),c&&e.jsx(B,{type:"error",children:c})]})]})}export{F as default};
