import{u as P,a as F,r as m,j as s,B as S,A as p,T as w,L as R}from"./index-CHYvOylt.js";import{F as k,a as A,P as f}from"./PasswordField-SPMNbbfb.js";import{C as g,U as B,P as T}from"./PasswordChecklist-B1zTHdOU.js";import{F as L}from"./FormButton-Dodv37vY.js";function N(){const x=P(),i=F(),[r,o]=m.useState({username:null,password:null,response:null}),[j,n]=m.useState(!1),[e,y]=m.useState({username:"",password:"",confirmPassword:""}),u={length:/^.{3,20}$/,validChars:/^[A-Za-z0-9_]+$/},c={length:u.length.test(e.username),validChars:u.validChars.test(e.username)},t={lowercase:/[a-z]/,uppercase:/[A-Z]/,number:/\d/,symbol:/[!@#$%^&*()_\-+=[\]{};:"\\|,.<>/?]/,length:/.{8,}/},h={length:t.length.test(e.password),lowercase:t.lowercase.test(e.password),uppercase:t.uppercase.test(e.password),number:t.number.test(e.password),symbol:t.symbol.test(e.password),passwordsMatch:e.password&&e.password===e.confirmPassword};function d(l){y({...e,[l.target.name]:l.target.value.trim()})}async function v(l){if(l.preventDefault(),o({username:null,password:null,response:null}),n(!0),Object.values(c).some(a=>!a)){n(!1),o(a=>({...a,username:"Please fix username validation errors"}));return}if(Object.values(h).some(a=>!a)){n(!1),o(a=>({...a,password:"Please fix password validation errors"}));return}try{const a=await fetch("https://blog-backend-production-16f8.up.railway.app/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),b=await a.json();if(!a.ok){o(C=>({...C,response:b.message||"Registration failed"})),n(!1);return}x("/login")}catch{o(a=>({...a,response:"Network error"}))}}return s.jsx(S,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1},children:s.jsxs(k,{width:400,name:"Register",onSubmit:v,children:[s.jsx(A,{label:"Username",name:"username",value:e.username,onChange:d}),s.jsx(g,{in:!!e.username,timeout:300,children:s.jsx(B,{validations:c})}),r.username&&s.jsx(p,{type:"error",children:r.username}),s.jsx(f,{label:"Password",name:"password",value:e.password,onChange:d}),s.jsx(f,{label:"Confirm Password",name:"confirmPassword",value:e.confirmPassword,onChange:d}),s.jsx(g,{in:!!(e.password||e.confirmPassword),timeout:300,children:s.jsx(T,{validations:h})}),r.password&&s.jsx(p,{type:"error",children:r.password}),s.jsx(L,{name:"Register",disabled:j}),r.response&&s.jsx(p,{type:"error",children:r.response}),s.jsxs(w,{sx:{mt:2,textAlign:"center",color:i.palette.text.secondary,fontSize:14},children:["Already have an account?"," ",s.jsx(w,{component:R,to:"/login",sx:{color:i.palette.primary.main,textDecoration:"none",fontWeight:600,"&:hover":{color:i.palette.primary.light}},children:"Login"})]})]})})}export{N as default};
