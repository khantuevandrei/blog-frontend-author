import{y as g,r as n,a as j,u as x,j as e,z as v,A as w}from"./index-D2KaLZNc.js";import{F as k,a as B,b as C}from"./FormButton-D_UYJ-45.js";import{B as F}from"./BackButton-BbDVQbHQ.js";import{B as P}from"./BodyField-DVSrKaLV.js";function T(){const{postId:i}=g(),{token:u}=n.useContext(j),m=x(),[y,h]=n.useState(null),[a,d]=n.useState({title:"",body:""}),[p,o]=n.useState(null),[c,l]=n.useState({overlay:!0,update:!1});n.useEffect(()=>{async function s(){l(t=>({...t,overlay:!0}));try{const t=await fetch(`https://blog-backend-production-16f8.up.railway.app/api/posts/${i}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`bearer ${u}`}}),r=await t.json();if(!t.ok){o(r.message);return}h(r),d({title:r.title,body:r.body})}catch{o("Network error")}finally{l(t=>({...t,overlay:!1}))}}s()},[i,u]);function f(s){d({...a,[s.target.name]:s.target.value})}async function b(s){if(s.preventDefault(),o(null),l(t=>({...t,update:!0})),!a.title.trim()||!a.body.trim()){o("Both title and body are required");return}try{const t=await fetch(`https://blog-backend-production-16f8.up.railway.app/api/posts/${i}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`bearer ${u}`},body:JSON.stringify(a)}),r=await t.json();if(!t.ok){o(r.message||"Post creation failed");return}m(`/${y.id}`)}catch{o("Network error")}finally{l(t=>({...t,update:!1}))}}return c.overlay?e.jsx(v,{}):e.jsxs(k,{width:600,name:"Update Post",onSubmit:b,children:[e.jsx(F,{nav:`/${i}`}),e.jsx(B,{label:"Title",name:"title",value:a.title,onChange:f}),e.jsx(P,{label:"Body",name:"body",value:a.body,onChange:f}),e.jsx(w,{error:p,children:p}),e.jsx(C,{name:"Update",disabled:c.update})]})}export{T as default};
