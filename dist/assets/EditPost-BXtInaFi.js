import{E as j,r as n,b as v,u as w,j as e,F as k,B as h,P as C,T as P,A as T}from"./index-DZSOC8iH.js";import{T as y,F as B}from"./FormButton-C8begN1v.js";import{B as E}from"./BackButton-CuzL5Agk.js";function F(){const{postId:i}=j(),{token:u}=n.useContext(v),d=w(),[x,b]=n.useState(null),[a,p]=n.useState({title:"",body:""}),[c,o]=n.useState(null),[f,l]=n.useState({overlay:!0,update:!1});n.useEffect(()=>{async function r(){l(t=>({...t,overlay:!0}));try{const t=await fetch(`https://blog-backend-production-16f8.up.railway.app/api/posts/${i}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`bearer ${u}`}}),s=await t.json();if(!t.ok){o(s.message);return}b(s),p({title:s.title,body:s.body})}catch{o("Network error")}finally{l(t=>({...t,overlay:!1}))}}r()},[i,u]);function m(r){p({...a,[r.target.name]:r.target.value})}async function g(r){if(r.preventDefault(),o(null),l(t=>({...t,update:!0})),!a.title.trim()||!a.body.trim()){o("Both title and body are required");return}try{const t=await fetch(`https://blog-backend-production-16f8.up.railway.app/api/posts/${i}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`bearer ${u}`},body:JSON.stringify(a)}),s=await t.json();if(!t.ok){o(s.message||"Post creation failed");return}d(`/${x.id}`)}catch{o("Network error")}finally{l(t=>({...t,update:!1}))}}return f.overlay?e.jsx(k,{}):e.jsxs(h,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1,minHeight:"100%",p:2,position:"relative"},children:[e.jsx(E,{onClick:()=>d(`/${i}`)}),e.jsxs(C,{elevation:3,sx:{p:4,width:"100%",maxWidth:500},children:[e.jsx(P,{variant:"h5",mb:2,sx:{fontWeight:500},children:"Update Post"}),e.jsxs(h,{component:"form",onSubmit:g,children:[e.jsx(y,{label:"Title",name:"title",margin:"normal",value:a.title,onChange:m,fullWidth:!0,required:!0,sx:{mb:2}}),e.jsx(y,{label:"Body",name:"body",margin:"normal",value:a.body,onChange:m,fullWidth:!0,multiline:!0,rows:6,required:!0}),e.jsx(B,{name:"Update",disabled:f.update})]}),c&&e.jsx(T,{type:"error",children:c})]})]})}export{F as default};
